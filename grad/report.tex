\documentclass[12pt, oneside, a4paper, titlepage]{report}
\usepackage{url}
\usepackage{hyperref}
\hypersetup{%
    hidelinks,
    pdfinfo = {%
        Author = {Paul Mabileau},
        Title = {Rapport de Mission en Entreprise},
        Subject = {Stage de fin d'études},
        Keywords = {%
            rapport,
            stage,
            ingénieur,
            intégration,
            sécurité,
            OCD,
            Orange Cyberdéfense,
        },
    },
}

\usepackage{nameref}
\usepackage{fancyvrb}
\usepackage[toc, acronym]{glossaries}
\usepackage[export]{adjustbox}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{pbox}
\usepackage[main = french]{babel}
\usepackage{moresize}
\usepackage{xcolor}
\usepackage{soulutf8}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{csquotes}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage[section]{placeins}
\usepackage{calc}

\usepackage{geometry}
\geometry{%
    paper = a4paper,  % Paper size, change to letterpaper for US letter size.
    top = 3cm,  % Top margin.
    bottom = 3cm,  % Bottom margin.
    left = 3.5cm,  % Left margin.
    right = 3.5cm,  % Right margin.
    headheight = 0.75cm,  % Header height.
    footskip = 1cm,  % Space from the bottom margin to the baseline of the footer.
    headsep = 0.5cm,  % Space from the top margin to the baseline of the header.
    %showframe,  % Uncomment to show how the type block is set on the page.
}

\usepackage[sorting = none]{biblatex}
\addbibresource{refs.bib}
\setacronymstyle{long-short-desc}
\loadglsentries{glossary.tex}
\makeglossaries{}

\input{include/vars}



\begin{document}

\begin{titlepage}
    \input{include/frontpage}
\end{titlepage}

\tableofcontents

\input{include/abstract}


\chapter{Remerciements}%
\label{cha:ackn}

Je tiens tout d'abord à remercier mon directeur de stage, Valentin Goron, pour
son suivi régulier du stage et des activités que j'y menais, pour souvent
m'orienter vers une personne prête à m'aider à résoudre quelconque problème. Je
remercie donc Guerric Lemoigne pour son accueil efficace et toutes les petites
opérations et questions qui viennent avec un début de stage, Andrès Marino pour
les dépannages en salle serveur, Arnaud Fauvel pour la rédaction du DEX, Deroi
Tieffi pour avoir été un bon taxi, Geoffrey Giganti pour le coup de pouce pour
démarrer en Stormshield, et j'en oublie d'autres.

Je remercie les chefs de projet avec qui j'ai eu l'occasion de collaborer, ne
serait-ce qu'un peu: Arnaud Creuser et surtout Laurent Saunier pour avoir
brillament géré un projet en mouvement constant, bourrés de changements de
dernière minute et fréquemment bloqué ou retardé par des imprévus sortant de nos
responsabilités.

Merci aussi à Gauthier pour les longues journées de nos débuts de stage passées
en salle de test à documenter, nettoyer, réorganiser et étiqueter tout ce qui
bouge --- ou en l'occurence plutôt pas trop.

Enfin, je tiens tout particulièrement à remercier Sylvain Bardy pour un travail
en binôme qu'il rend toujours efficace mais surtout agréable du fait de son
soutien constant et de sa bonne humeur inconditionnelle. Même lorsque contraint
à devoir jongler entre plusieurs projets dont d'autres bien plus prenant, il
était toujours prêt à répondre à mes nombreuses questions et interrogations,
voire à se libérer d'une minute à l'autre pour résoudre divers problèmes
ensemble sans pour autant le demander. Je pense sincèrement que la réussite du
projet en question et de la fin de mon stage peut lui être attribuée en grande
partie. Merci beaucoup.


\chapter{Introduction}%
\label{cha:intro}

\section{Stage}%
\label{sec:intro::stage}

Aujourd'hui, la sécurité est souvent citée comme un enjeu majeur pour les
entreprises ainsi que pour l'ensemble des acteurs qui l'entourent. Elle n'est
plus confinée uniquement au rôle de l'informaticien. Le domaine devient de plus
en plus important à cause de la transition progressive vers des systèmes
informatiques~\cite{reliance}, de l'Internet et de protocoles réseau sans fil
tel que Bluetooth ou Wi-Fi, et de la constante augmentation du nombre
d'appareils <<intelligents>> tels que téléphones et télévisions modernes et les
nombreux types différents d'appareils constituant <<l'Internet des objets>>. Du
fait de sa complexité grandissante, à la fois en termes politiques et
technologiques, la cybersécurité est aussi un des défis proéminents du monde
contemporain~\cite{global-cyber}. Ces raisons amènent alors de nombreuses
entreprises à investir un temps et un budget significatif à l'établissement
d'une sécurité opérationnelle éstimée adaptée aux contraintes liées à leur cœur
de métier. C'est dans ce cadre que s'incrit l'activité d'Orange Cyberdéfense et
en particulier mon stage.

Mon stage avait pour domaine principal l'\gls{integ} d'outils de sécurité pour
le compte de clients d'Orange Cyberdéfense. Comme ceux-ci sont variés, les
projets associés abordent des sujets plus ou moins spécifiques, des enjeux et
contraintes différents, une criticité de la sécurité adaptée, des durées et
budgets variés, \ldots{} L'idée est donc de les accompagner dans une démarche
d'identification de sujets et problèmes de sécurité les concernant directement,
d'amélioration de leurs infrastructures, logiciels et configurations, et de
conception d'architectures adaptées à l'implémentation de ces changements dans
le cadre d'un projet dédié.

L'\gls{integ} de système est une activité d'ingénierie qui consiste en le
processus de mise en relation de différents systèmes, souvent disparates, dans
le but qu'ils deviennent composants d'un nouveau système plus global. En
informatique, il peut s'agir de connexion physiques entre machines ou logiques
entre logiciels. En sécurité, cela ajoute certaines contraintes, notamment de ne
pas s'arrêter uniquement au bon fonctionnement du système global mais d'inclure
aussi le non-fonctionnement souhaité de ce qui n'appartient pas au système.


\section{Présentation de l'entreprise}%
\label{sec:intro::entreprise}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/logo/ocd.png}
    \caption{Logo de la marque \acrlong{ocd}}%
    \label{fig:logo/ocd}
\end{figure}

\Gls{ocd} SAS est une filiale d'\gls{obs}, elle-même filiale et marque
commerciale du groupe Orange. \gls{ocd} est spécialisée dans la prestation de
services en cybersécurité: elle accompagne les entreprises dans la sécurisation
de leurs activités et de leurs données. L'entreprise a son siège dans le
quartier de La Défense, en région parisienne et compte plus de 2500
collaborateurs dont plus de 250 chercheurs et analystes à travers le monde,
répartis dans 160 pays~\cite{ocd}.

\acrlong{ocd} a été fondée en 2014 et dirigé jusqu'en avril 2021 par Michel Van
Den Berghe. La marque est créée en 2016, regroupant les activités en
cybersécurité d'Orange Consulting et d'Atheos, cabinet de conseil racheté en
2014~\cite{rachat-atheos}.  La filiale a ensuite évoluée avec le rachat de Lexsi
en 2016 puis SecureData et SecureLink en 2019 pour une valeur de 515 millions
d'euros~\cite{rachat-securelink}. La direction est reprise en avril 2021 par
Hugues Foulon.

Financièrement et humainement, l'entreprise a connu une forte croissance depuis
sa création. Entre 2016 et 2020, \gls{ocd} a eu une croissance de chiffre
d'affaires de 21,3\% en moyenne, pour atteindre 300 millions d'euros en 2020 et
768 millions d'euros en 2020 aussi en prenant en compte toutes les acquisitions
de la filiale~\cite{ocd}. Le résultat net quant à lui a quelque peu oscillé au
fur et à mesure des années, mais était par exemple de 2,984 millions d'euros en
2016, 883 milliers d'euros en 2018 et 1,826 millions d'euros en 2020. L'effectif
salarial est lui aussi en augmentation assez régulière depuis 2015 avec en
moyenne 30,0\% de croissance jusqu'à fin 2020, pour atteindre plus de 1100
employés début 2021~\cite{finances-ocd}. L'ensemble du détail des finances de
l'entreprise est mis à disposition en annexe~\ref{sec:annexes::finances-ocd}.

\acrlong{ocd} propose une notable variété de services informatiques en sécurité.
Ils contiennent en particulier au niveau purement technique: du conseil, de
l'audit organisationnel et de sécurité par tests d'intrusion, de la détection de
menaces de manière transparente aux clients et des réponses automatisées, de la
conception d'architectures nouvelles ou en vue d'une migration avec de
l'\gls{integ}, et enfin du support et du \gls{soc} pour atteindre un \gls{mcs}.
Il y a aussi des services plus orienté sur l'axe humain de la sécurité: des
formations visant à sensibiliser les employées d'une entreprise cliente, mais
aussi de l'assistance à la gestion de crise~\cite{ocd}.  Puisque je n'ai fait
partie que de l'équipe d'\gls{integ}, je ne serais en mesure de préciser la
structure interne et le fonctionnement précis des autres équipes. Leur
intervention dans le déroulé d'un projet complet sera cependant abordé en de
plus amples détails dans la partie~\ref{cha:mission} --- \nameref{cha:mission}.

En particulier, l'offre de filtrage délocalisé et réponse automatisée à incident
est réalisée grâce à des infrastructures que l'entreprise a conçues et maintient
soi-même. \acrlong{ocd} héberge au sein de 26 centres de détection dans 13 pays
du monde de quoi analyser en moyenne 50 milliards d'évènements par jour, ce qui
permet notamment de révéler et rapidement clotûrer en moyenne plus de 200 sites
Web détectés malveillants par jour.


\section{Acteurs du marché}%
\label{sec:intro::acteurs}

La sécurité informatique est un enjeu majeur pour toute entreprise et surtout
constant dans le temps. En effet, la migration vers une informatique généralisée
rend la surface d'attaque en général de plus en plus importante. Les attaques
informatiques sont réalisées en permanence et sont surtout de types très variés.

Rien que dans les ménages français par exemple, les personnes faisant face à des
problèmes de sécurité rencontrent huit catégories d'attaques différentes et
déclarent dans 42,5\% des cas avoir été sujet à du hameçonnage par réception
d'un message invitant à se connecter à un site Web frauduleux et dans 21,4\% des
cas par redirection vers un site frauduleux invitant à fournir des informations
personnelles lors d'une navigation Web~\cite{attack-types}.

Cela concerne tout aussi bien les entreprises du secteur privés: 16\% des
sociétés de 10 personnes ou plus implantées en France déclarent avoir vécu un
incident de sécurité informatique en 2018. Les sociétés de 250 personnes ou plus
sont deux fois plus touchées~\cite{companies-security}. Le simple coût lié à la
gestion de la crise déclenchée par une attaque et aux réparations qui
s'ensuivent est conséquent: il est aux États-Unis en moyenne de 27,4 millions de
dollars et en France de 9,72 millions de dollars USD~\cite{attack-costs}. Cela
les amène alors à investir un budget et un temps considérable pour se protéger
en conséquence: en 2019, 87\% de sociétés de 10 personnes ou plus réalisent des
activités en lien avec la sécurité de leur système d'information. Par ailleurs,
67\% des sociétés ont recours à des prestataires pour réaliser des activités de
sécurité informatique, parfois en plus des employés de l'entreprise, et 20\% les
font réaliser uniquement par leurs propres employés, tandis que les grandes
entreprises uniquement le font à 31\%. Ces activités comprennent notamment de
l'édition de communications internes: 26\% des sociétés ont une documentation
sur les mesures, pratiques ou procédures en matière de sécurité des systèmes
d'information, autant qu'en 2015. C'est le cas de 71\% des sociétés de 250
personnes ou plus. Quelle que soit leur taille, sept sociétés sur dix ont défini
ou révisé cette documentation au cours de l'année
écoulée~\cite{companies-security}.

Cette masse d'entreprises ayant recours à des prestataires de services externes
pour les aider à réaliser toutes ces activités particulièrement chronophages est
alors très importante. Le marché associé est donc évidemment conséquent: en
2020, il a représenté à l'échelle globale environ 133 milliards de dollars
USD~\cite{security-market}, dont 96,3 en services de
consultation~\cite{security-consulting-market}, ce qui inclus la grande partie
des activités d'\gls{ocd} par exemple. \acrlong{ocd} est en plus de cela sur la
plupart des fronts de la sécurité (voir la section
précédente~\ref{sec:intro::entreprise}), puisque sert notamment à plus de 8000
clients de tous secteurs d'activité~\cite{ocd}. Son marché direct est alors de
très grande taille et les acteurs y participant en grand nombre. Quant à
certains en particulier, nous citerons par exemple Atos et Wavestone pour la
partie conseil et conception d'architectures, Synacktiv et Quarkslab pour la
partie audit de sécurité et tests d'intrusion, ou encore Login Sécurité en
partie pour les opérations de \gls{soc}.


\chapter{Mission}%
\label{cha:mission}

Ma mission était, d'un point de vue assez global, de participer aux divers
projets et activités de l'équipe d'ingénieurs en \gls{integ} faisant partie du
département <<Solutions de confiance>> d'\acrlong{ocd}. Cette équipe est
elle-même composée de deux sous-équipes: le \gls{ocd-build} et le \gls{ocd-run}.
Le \gls{ocd-build} est chargé d'une partie de la conception de l'architecture à
mettre en place pour répondre aux besoins d'un client, puis surtout de son
implémentation effective qui nécessite souvent une intervention matérielle et
l'établissement de configurations logicielles cibles, pour enfin réaliser une
migration vers le nouveau système. Le \gls{ocd-run} quant à lui est chargé
d'assurer le bon fonctionnement du système implémenté par le \gls{ocd-build} de
sorte qu'il soit opérationnel la majeure partie du temps, de surveiller la
sécurité du parc informatique en question et donc réaliser le rôle de \gls{soc},
mais aussi de faire évoluer les configurations logicielles au fur et à mesure
des demandes du client par voie de tickets. J'ai, pour ma part, rejoint en
particulier l'équipe \gls{ocd-build} pour la durée entière de ce stage.


\section{Déroulé d'un projet}%
\label{sec:mission::deroule-projet}

Ces deux sous-équipes plus d'autres d'\gls{ocd} travaillent ensemble pour
réaliser de nombreux projets. Le déroulé typique d'un projet est le suivant,
principalement orienté du point de vue du \gls{ocd-build}:

\begin{itemize}

    \item Optionnellement, les équipes d'audit et de conseil ont révélé des
        problèmes de sécurité que l'entreprise ayant pris contact avec \gls{ocd}
        ne juge pas acceptable face aux risque potentiellement encourus par
        rapport à la criticité des applications, systèmes et informations
        concernés. La partie conseil va en particulier intervenir surtout pour
        la gestion des opérations suite à la mise en évidence des faiblesses en
        question, pour définir des objectifs les plus clairs possibles en terme
        de sécurité et pour établir une stratégie d'évolution pour les atteindre
        en temps souhaité.

    \item Un projet peut tout aussi bien commencer à l'inverse par une prise de
        contact du client vers \gls{ocd}, par exemple suite à un appel d'offres,
        avec des objectifs déjà proprement définis et pour aller directement
        vers l'implémentation. Il s'agit dans ce cas en général de construction
        d'infrastructures entièrement nouvelles ou d'une migration relativement
        importante de systèmes pour laquelle le client a été en mesure d'en
        identifier la nécessité. Une partie non-négligeable de la conception est
        alors réalisée par les \gls{presales} en collaboration avec le client.
        Leur rôle va principalement être de comprendre et synthétiser les
        besoins du client pour aller vers un premier jet d'une architecture
        adaptée. Si la taille du parc informatique concerné est particulièrement
        conséquente, un ou plusieurs architectes de systèmes peuvent aussi
        intervenir.

    \item Une fois la majeure partie de l'architecture conçue, le
        \gls{ocd-build} commence alors à participer au projet pour tendre vers
        une spécification précise des changements qui vont être réalisés ou de
        l'infrastructure qui va être effectivement implémentée. Ceci commence en
        général par une \gls{rli}. C'est une réunion de coordination interne à
        \gls{ocd} en début de projet pour réaliser une transition entre les
        \gls{presales} et les équipes de \gls{ocd-build} afin de transmettre les
        informations importantes. Elle est en général relativement courte car il
        s'agit principalement de se mettre d'accord sur ce qui va être présenté
        au client et ainsi de préparer la \gls{rle}. Cette dernière est une
        réunion de début de projet pour le \gls{ocd-build} suite à la \gls{rli}
        cette fois-ci avec le client présent pour d'abord faire rencontrer les
        différentes personnes des deux côtés, puis commencer à préparer une
        spécification précise de l'implémentation à réaliser et le continuer
        selon la taille du projet dans les jours, semaines ou mois suivants lors
        d'une série d'ateliers techniques.

    \item Le \gls{ocd-build} ayant réellement commencé le projet, ils vont
        chercher à rédiger une spécification de l'architecture à implémenter et
        déployer afin d'obtenir un accord de la part du client à son sujet et
        donc ainsi d'avoir à portée de main une forme de guide contenant toutes
        les informations à configurer sur les différents composants du système
        global à mettre ne place. Cela permet aussi de proposer un cadre pour
        les changements en cours de route: si le client avait bien approuvé la
        spécification effective et qu'\acrlong{ocd} l'implémente en entier ou
        presque mais que le client exprime finalement un mécontetement qui
        demanderait de revoir une grande partie de l'architecture, \gls{ocd}
        peut alors s'en défendre en rappelant l'approbation en question; le
        client devra, s'il le souhaite effectivement, renégocier les contrats et
        acheter de nouveau du temps de travail. Selon la taille du projet, cette
        spécification peut prendre plusieurs formes différentes:

    \begin{itemize}

        \item Si le projet est particulièrement conséquent car fait intervenir
            de nombreuses équipes, demande de déployer beaucoup de sites,
            nécessite un grande variété de configurations, types d'équipements
            ou logiciels, \ldots{} il est alors fréquent de séparer cette
            rédaction en deux parties: un \gls{hld} puis un \gls{lld}. Un
            \gls{hld} est un dossier regroupant les spécifications de
            l'architecture à implémenter d'un point de vue assez global en
            partant de l'idée générale de départ proposée par les
            \gls{presales}. Il ne s'agit pas de préciser toutes les valeurs
            effectives des options principales de configurations cibles à mettre
            en place: c'est plus le rôle du \gls{lld} qui en découle. Ce dernier
            est un dossier regroupant les spécifications les plus détaillées
            possibles de l'architecture à implémenter telles que modèles de
            machine à déployer, versions de systèmes d'exploitation à installer,
            interfaces, adresses, routes, options, autorisations, règles,
            objets, \ldots{} à configurer. Il est en général une continuation
            directe du \gls{hld} associé. Cette séparation en deux permet
            notamment d'un peu mieux gérer la communication car se fait à
            propose des bons sujets lors des ateliers techniques, mais aussi la
            répartition du temps de travail des ingénieurs car évite si possible
            de nombreux aller-retours entre la spécification et
            l'implémentation.

        \item Si le projet n'est à l'inverse pas trop gros, il est souvent
            envisagé de passer directement à un \gls{dsd}. C'est un dossier très
            similaire à un \gls{lld}, car comportera le même genre de contenu
            précis, mais est plutôt employé lorsque la taille du projet n'est
            pas trop conséquente et permet donc de rédiger directement les
            spécifications de l'implémentation en un temps moins long puisque la
            plupart des sujets abordés lors d'ateliers techniques avec le client
            ne posent pas de problème particulier et ne sont donc pas bloquants.
            Pour résumer, un \gls{dsd} est une forme de fusion entre un
            \gls{hld} et un \gls{lld}.

    \end{itemize}

    \item Une fois la spécification rédigée, ajustée et approuvée par le client,
        l'équipe d'ingénieurs \gls{ocd-build} dédiée au projet commence
        l'implémentation. Cela démarre régulièrement par une étape de
        \gls{staging}: placer les équipements dans un environnement de test qui
        s'approche le plus possible de l'environnement de production effectif.
        L'intérêt est que cela permet de vérifier certaines parties du système,
        comme par exemple l'interaction avec une base de données externe, qui
        sont dans un environnement de test plutôt en local sur le même hôte,
        mais aussi d'être en mesure d'avoir un contrôle plus important de
        l'environnement global, comme par exemple vider la base de données et y
        charger des données de test qui couvre des cas précis. Cela permet
        aussi, lorsque cela peut s'appliquer, de vérifier le bon fonctionnement
        de machines physiques pour gérer en interne les potentiels dégâts liés
        au transport des marchandises. Avec une première configuration embarquée
        dans les équipements, le déploiement dans l'environnement de production
        peut donc se faire de manière plus rapide sur place car il s'agit
        principalement de visser les machines, de les alimenter, connecter et
        démarrer, mais aussi de manière plus sereine car une bonne partie des
        cas ont déjà été vérifiés. Après cette étape, l'architecture est
        déployée et configurée petit à petit jusqu'à atteindre un état cible ou
        presque.

    \item Quand l'implémentation arrive vers sa fin, le \gls{ocd-build} commence
        à rédiger en parallèle un \gls{dtv} par site déployé. Il regroupe un
        ensemble de fiches de tests d'acceptation à effectuer avec succès pour
        considérer le déploiement du site et la migration globale comme des
        succès, et ainsi que le site soit considéré comme livré au client. Ces
        tests peuvent très bien être entièrement automatisés ou bien faire
        intervenir une certaine part d'actions manuelles: c'est en général le
        cas pour les vérifications de bascule lorsque que la redondance physique
        fait partie de l'architecture globale.  Les différents \glspl{dtv} sont
        complétés et validés par le client au fur et à mesure de quelques
        itérations, comme la majeure partie des documents produits.

    \item Après que le \gls{dtv} d'un site est bien validé et que son
        implémentation est terminée par le \gls{ocd-build}, une \gls{vabf} est
        planifiée et effectuée avec le client. Il s'agit d'une session lors de
        laquelle tous les tests d'acceptation du \gls{dtv} associé sont exécutés
        et leur résultats respectifs rapportés dans le document. Si un nombre
        particulièrement important de tests échouent, il est tout à fait
        envisageable de réaliser une nouvelle itération d'implémentation et par
        la suite de planifier et exécuter une seconde \gls{vabf} entière. Si
        seulement un nombre relativement faible de tests échouent, que certains
        n'ont simplement pas pu être réalisés puisque des éléments humains ou
        techniques manquaient ou que certains sont considérés non statisfaisants
        --- c'est-à-dire une forme d'échec partiel où dans certaines conditions
        estimées non courantes les systèmes ne fonctionnent pas comme attendu,
        il est alors possible de considérer la \gls{vabf} comme un succès avec
        quelques retenues tout de même. Les problèmes sont réglés dans les jours
        qui suivent par le \gls{ocd-build} et vérifiés en dehors d'une seconde
        \gls{vabf}.

    \item Si les résultats de tous les tests sont des succès, la \gls{vabf} est
        bien complétée, les ingénieurs \gls{ocd-build} sont libérés du projet et
        le site en question entre dans une période dite de \gls{vsr}. Pendant
        cette période d'une durée définie en accord avec le client, celui-ci
        utilise l'environnement de production cible déployé et fonctionnel du
        point de vue des tests déjà effectués, mais cette fois-ci pour vérifier
        que cela reste le cas dans la durée, c'est-à-dire qu'il n'y ait pas de
        comportement erratique ou d'instabilité seulement à certains moments de
        la journée par exemple, ou lorsque les systèmes sont soumis à de fortes
        charges, ou encore de temps en temps de manière totalement stochastique.
        Cette durée est en général de deux semaines pour les projets
        d'\acrlong{ocd}, mais peut être étendue principalement sur demande du
        client pour des projets dont ce genre d'aspects est jugé
        particulièrement critique au bon fonctionnement global du système
        considéré. Lors de la \gls{vsr}, l'équipe de \gls{ocd-build} réalise les
        corrections demandées par le client en mode <<meilleur effort>>,
        c'est-à-dire que les ingénieurs en question vont y passer le temps
        qu'ils peuvent, mais n'en feront pas pour autant une priorité puisqu'ils
        ne sont plus affectés au projet concerné et peuvent très bien faire déjà
        partie d'un autre projet. Cependant, si un dysfonctionnement majeur se
        produit et qu'il s'agit d'une erreur de la part de l'équipe, \gls{ocd}
        se doit de refaire une itération de \gls{ocd-build}, mais s'il s'agit
        d'un problème qui ne leur est pas attribuable, le client devra alors
        payer pour une nouvelle itération s'il le souhaite.

    \item Optionnellement, un \gls{dex} est rédigé en parallèle et sur demande
        du client. C'est une compilation systématique des procédures et des
        opérations que l'administrateur ou l'opérateur du système effectue. Un
        tel dossier leur sert aussi souvent de référence, autant pour du partage
        d'informations que de base pour leur travail quotidien. Il peut
        également contenir des descriptions pour le traitement de demandes
        spéciales et d'éventualités, mais aussi de petits changements à réaliser
        eux-mêmes. Cela permet notamment de clarifier, documenter l'architecture
        effectivement implémentée \textit{versus} celle initialement prévue dans
        un éventuel \gls{dsd}. Ce genre de document est en général produit
        lorsque le client va être en mesure d'administrer son propre système
        potentiellement sans aucune intervention de la part du \gls{ocd-run}, et
        pour ainsi lui fournir l'ensemble des éléments pratiques nécessaires de
        sorte que toutes ses opérations régulières puissent être réalisées.

    \item Quand toutes ces étapes-là sont bien complétées, le projet est en
        quelque sorte terminé, mais l'interaction entre \gls{ocd} et le client
        continue cependant par une transition vers le \gls{ocd-run}. Après une
        passation des informations importantes des équipes du \gls{ocd-build}
        vers le \gls{ocd-run}, celui-ci prend pleinement possession des
        interventions à réaliser sur le parc informatique précédemment déployé
        et ainsi assurer le rôle de \gls{soc} si cela fait partie du contrat
        négocié avec le client. Quelconque modification que souhaite faire le
        client, si encore une fois ils n'ont pas exprimé et négocié dans le
        contrat le besoin d'aussi pouvoir gérer les systèmes eux-même, il devra
        alors ouvrir un ticket auprès du \gls{ocd-build} afin que ces derniers
        appliquent le changement souhaité. Un tarif au tiquet ou groupe de
        tiquets est appliqué.

\end{itemize}

En somme, ce mode de travail est assez similaire à la méthode dite de la
<<cascade>> où les étapes sont enchaînées sans vraiment prendre en compte la
possibilité de retour en arrière et encore moins de cycle, ou en tout cas ne pas
la souhaiter. Même si elle a en théorie certains avantages, puisque cherche à
formaliser les choses à l'avance afin de simplement suivre le flot <<naturel>>
des évènements, elle a tout de même certaines absurdités. En effet, si on
cherche à la respecter de la manière la plus stricte possible et que, par
exemple, on se rende compte d'une erreur dans la spécification lors de
l'implémentation voire des tests, que fait-on? on continue la chaîne en
outre-passant le problème? on abandonne le projet? on démissionne? Même si on
relâche un peu la définition, cela n'est en fait pas très adapté à certains
projets, comme nous le verrons plus tard. Évidemment, une solution est de
changer de méthode en appliquant par exemple le <<cycle en V>>, au moins de
manière partielle, mais selon mon expérience chez \gls{ocd}, je n'ai pas
l'impression qu'il s'agisse vraiment de ce qui est employé. Cependant, je pense
aussi qu'il n'est pas non plus idéal d'aller à l'extrême opposé, c'est-à-dire de
considérer que rien n'est prévisible et de s'appuyer sur un cycle fréquent pour
effacer les bosses soulevées par des problèmes de conception qui en réalité
auraient pu être prévus. Un minimum de conception à l'avance est toujours
possible et même plus que souhaitable.


\section{Objectifs}%
\label{sec:mission::objectifs}

\acrlong{ocd} étant principalement un prestataire de service, une bonne partie
des objectifs du stage n'ont pas pu être définis à l'avance et de manière
précise, puisque les activités que j'y ai menées dépendaient fortement des
clients et de leur projets en cours. On peut tout de même mettre en évidence les
points suivants:

\begin{itemize}
    \item Apprendre en auto-formation à utiliser les divers produits faisant
        partie des spécialités \gls{ocd} et pouvant être concernés par un de ses
        projets pour aller vers une maîtrise et ainsi participer aux projets en
        tant qu'ingénieur.
    \item Concevoir et implémenter des architectures sécurisées.
    \item Élaborer des documentations techniques, spécifications générales et
        détaillées.
    \item Réaliser des projets: ingénierie, déploiement, migration / mise en
        production, transferts de connaissances, \ldots{}
    \item Contribuer à des activités purement internes telles qu'améliorer les
        infrastructures des salles de test, y déployer de nouvelles maquettes,
        participer au développement de nouvelles expertises, \ldots{}
\end{itemize}


\section{Premières missions}%
\label{sec:mission::prems}

\subsection{Auto-formation}%
\label{sub:mission::prems::auto-formation}

La toute première partie de mon stage consistait en un apprentissage sur une
durée d'un peu plus de deux semaines en auto-formation. Il s'agissait de monter
en compétences sur les quelques technologies apparaissant fréquemment d'un
projet client à un autre, restant assez génériques et ne nécessitant pas de
connaissances particulièrement avancées par rapport à ce qui peut être attendu
d'un futur diplômé d'une école d'ingénieur. Certaines des technologies listées
ci-après ont été étudiées après la première période, mais cela restait fait en
autonomie.

Premièrement, à la demande explicite de mon directeur de stage, je me suis
penché sur Fortinet et plus spécifiquement leur pare-feu FortiGate.  Fortinet
est une entreprise américaine multi-nationale basée en Californie et qui propose
divers produits de cybersécurité tels que pares-feux, anti-virus, systèmes de
détection et prévention d'instrusions et sécurité des terminaux~\cite{forti}.
Leur produit principal reste cependant leur gamme de pare-feux \gls{fgt} que
j'ai donc étudiée grâce à leur formations en ligne~\cite{fgt}. Je me suis aussi
formé sur leur solution de gestion centralisée \gls{fmg}~\cite{fmg} et leur
système de récolte et analyse centralisée de journaux \gls{faz}~\cite{faz}. J'ai
ensuite abordé les produits Palo Alto Networks~\cite{pan}. Cette autre
multi-nationale américaine aussi basée en Californie propose des produits
principalement centrés autour de leur pares-feux~\cite{pan-pa}, notamment en
\textit{cloud}. Enfin, j'ai dû m'intéresser pour le même projet à Microsoft
Azure, hébergeur public et fournisseur de \textit{cloud}~\cite{azure}.

\subsection{Documentation de la salle de tests}%
\label{sub:mission::prems::doc-salle-tests}

En parallèle, un autre stagiaire et moi avions été chargés d'une série de
petites opérations à réaliser pour la salle de tests. Les bureaux de Massy sont
équipés d'une <<petite>> salle serveur comprenant une douzaine de baies pouvant
contenir chacune une quarantaine d'unités standards. Une unité de \textit{rack},
souvent abbréviée \textbf{U} ou \textbf{RU}, est une unité de mesure pour les
tiroirs ou \textit{racks} d'une baie de déploiement pour divers appareils en
général informatiques~\cite{rack-unit}. Une telle baie contient typiquement 42
unités. La salle de tests est principalement utilisée pour déployer des
maquettes pour des projets client afin de servir d'environnement de
pré-production (\gls{staging}).  Elle permet aussi aux différents ingénieurs
\gls{ocd-build} et \gls{ocd-run} de mettre en place leurs propres essais dans le
but par exemple de se familiariser avec les produits d'un fabriquant donné ou
bien encore d'en soummettre à de grosses charges afin de déterminer si les
capacités théoriques annoncées sont en pratique vérifiées.

Les bureaux de la région parisienne ayant emménagés relativement récemment dans
les locaux de Massy, la salle de tests avait en particulier été transportée et
installée en un temps un peu trop court pour tout faire au mieux. Certaines des
infrastructures ont donc été mises en place de manière incomplète ou mal
documentée. Notre rôle en début de stage était alors de réaliser une revue la
plus complète possible des baies du \gls{ocd-build} et surtout celles dont
certaines parties contenaient des équipements internes, c'est-à-dire ne faisant
pas partie d'une maquette client. Nous devions vérifier que les choses étaient
bien installées comme il le fallait et retirer ce qui n'avait désormais plus sa
place dans la salle. Ensuite, nous nous sommes occupés d'assurer une meilleure
documentation des baies en étiquetant la majeure partie des équipements présents
ainsi que les divers câbles les reliant. Nous en faisions de même dans les
configurations des équipements en changeant leur nom d'hôte et en ajoutant des
descriptions à leurs interfaces si possible. Enfin, nous avons dû réaliser un
inventaire des baies et de la réserve adjacente afin de résumer tout ce qui
existe dans l'environnement de test et ce qui est disponible à l'installation.


\section{Deuxième mission: projet SNCF}%
\label{sec:mission::deuz}

La deuxième mission qui m'a été confiée aura été de participer à la rédaction
d'un \acrfull{dex} dans le cadre d'un projet en approche de fin pour le compte
de la \gls{sncf}. Le projet, nommé <<\textit{Access}>> consistait en la mise en
place d'une architecture publique \textit{cloud} avec l'objectif de fonctionner
en tant que zone tampon pour les flux provenant de l'Internet public et à
destination des applications \gls{sncf} publiques. Ces applications étaient
souvent des applications Web, mais n'y étaient pas restreintes car tout type
était permis tant qu'il était transporté par \gls{tcp} ou \gls{udp}. Cette zone
de sécurité avait pour but l'analyse avancée du trafic, à travers du \gls{waf}
et de l'\gls{ips}.  Elle devait également permettre l'évasion vers l'Internet du
trafic provenant des \glspl{dmz} publiques et privées. Un aperçu de
l'architecture globale est rendue disponible en
Figure~\ref{fig:sncf-access/arch}.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.9\linewidth]{img/sncf-access/arch.png}
    \caption{%
        Vue d'ensemble de l'architecture du projet SNCF \textit{Access} sous
        \textit{Azure}%
    }%
    \label{fig:sncf-access/arch}
\end{figure}

Cette architecture suit principalement un modèle en couches pour assurer une
protection à divers niveaux, tels que réseau, applicatif et anti-virus. Une
description de ces couches suit:

\begin{itemize}
    \item Un niveau de \acrlong{fgt} est utilisé comme pare-feu externe. Il est
        en charge du filtrage fin niveau 3/4 des flux au sein d'\textit{Access}.
    \item Un niveau de F5 est utilisé comme second bastion. Il est en charge du
        \gls{waf}, avec du déchiffrement \gls{tls} souvent appelé
        <<déchiffrement \gls{ssl}>>.
    \item Un niveau de Palo Alto est utilisé comme troisième bastion. Il est en
        charge de l'analyse \gls{ips}.
    \item Un niveau de F5 est utilisé comme quatrième bastion. Il est en charge
        du rechiffrement des flux et fonctionne en tant que \gls{rev-proxy} pour
        rediriger le trafic vers les serveurs adéquats.
    \item Un groupe de F5 DNS est utilisé afin d'assurer la résilience entre
        chaque niveau d'équipements.
\end{itemize}

Le \gls{dex} demandé sortait légèrement de la norme habituellement employée pour
la plupart des autres projets. Au lieu de demander un résumé des opérations
d'exploitation, ce qu'ils avaient déjà en partie reçu avant mon arrivée sur le
projet, ils souhaitaient cette fois-ci plus une forme de guide d'implémentation
de nouveaux services. Il s'agit donc moins d'une documentation liée à
l'exploitation des infrastructures déployées, mais plutôt à leur modification en
cas de changement relativement mineur du point de vue du système global. Cela
leur était possible car faisait tout simplement partie des livrables du projet:
la \gls{sncf} souhaitait être en pleine mesure de contrôler ses sytèmes.

Nous nous sommes alors chargés de rédiger ce document afin de répondre à la
demande du client. L'axe principal était orienté autout de: comment déployer un
nouveau service au niveau d'\textit{Access}? Nous devions donc détailler le plus
précisément possible l'ensemble des étapes à réaliser à cette fin et ce, pour
chacune des couches définies ci-dessus. Cela impliquait notamment d'inclure
diverses captures d'écran, tableaux résumant certaines informations primordiales
aux étapes concernées, explications et rappels généraux, instructions
spécifiques, \ldots{} Je m'étais personnellement occupé des parties concernant
les opérations sous \acrlong{fgt} pour lesquelles j'ai pu utiliser mes
connaissances fraîchement acquises et celles sous Azure et Palo Alto pour
lesquelles j'ai dû me former tel que mentionné à la
Section~\ref{sub:mission::prems::auto-formation}.  J'ai par ailleurs dû
manipuler directement les ressources de ces quelques technologies déjà déployées
en production afin de produire la majeure partie des sections du document dont
j'étais chargé, même si cela restait assez limité comparé à la mission
principale détaillée en Section~\ref{sec:mission::main}.


\section{Mission principale: projet Hynamics}%
\label{sec:mission::main}

\subsection{Considérations générales}%
\label{sub:mission::main::gen}

Hynamics est une filiale du groupe \gls{edf} fondée en avril 2019~\cite{hy}.
Elle se spécialise dans la production de dihydrogène ($H_2$ et par abus de
langage simplement <<hydrogène>>) renouvelable et à basse émission de dioxyde de
carbone ($CO_2$). Puisque c'est une entreprise assez jeune, peu de choses
visibles concrètement n'avaient été réalisées avant l'été 2021. Ses deux
premières années ont été consacrées à la conception de leurs plateformes, la
formation de partenariats pour la construction et la production, la mise en
place de contrats à l'avance, etc\ldots{} C'est au début de l'été 2021
qu'Hynamics commence à déployer ses sites de test et de production, en restant
en France pour une première étape. Ces sites ayant besoin d'accès à l'Internet
de manière spécifique et \gls{edf} ayant une culture de la sécurité assez
dévoloppée et présente du fait de leurs applications particulièrement critiques,
Hynamics a contacté \acrlong{ocd} afin de sécuriser leurs infrastructures.

Hynamics possède en début de projet trois sites qui en feront partie: le
<<quartier général>> à La Défense (raccourci DEF) qui ne portera pas vraiment de
production ni industrielle ni informatique à proprement parler, un espace sur la
plateforme de test <<Les Renardières>> (RNRD) d'\gls{edf} près de Fontainebleau
et le premier site de production près d'Auxerre (AUXR). Les objectifs d'Hynamics
pour ces infrastructures étaient de:

\begin{itemize}
    \item Isoler les sites de l'Internet public le plus possible.
    \item Empêcher les sites de communiquer entre eux.
    \item Isoler les uns des autres les équipements des partenaires installés
        sur site le plus possible.
    \item Relier les sites de production au site de La Défense pour permettre
        une gestion centralisée et la remontée des journaux.
    \item Permettre l'accès aux sites en VPN <<\gls{ssl}>> aux collaborateurs
        d'Hynamics et certains de ses partenaires en ayant fait la demande.
    \item Permettre l'accès aux sites en montant des \glspl{tun-ipsec} avec des
        équipements distants de partenaires pour les opérations automatisées.
    \item Obtenir une haute disponibilité acceptable.
\end{itemize}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/doc-hy/global-arch.png}
    \caption{Architecture globale du projet Hynamics}%
    \label{fig:doc-hy/global-arch}
\end{figure}

L'architecture présentée en Figure~\ref{fig:doc-hy/global-arch} montre le
premier jet conçu par les \gls{presales}. Il montre une vue d'ensemble de ce qui
sera par la suite détaillé et implémenté. Voici quelques détails supplémentaires
à propos de l'architecture qui découlent de la proposition faite par les
\gls{presales}:

\begin{itemize}
    \item Chaque site possède un pare-feu principal qui s'occupe d'agir en tant
        que routeur pour le réseau local et ainsi sa passerelle par défaut pour
        tout accès externe. Il fournit la majeure partie de la sécurité d'un
        site dans ce projet.
    \item Chaque réseau local, sauf celui de La Défense, possède un commutateur
        configurable et capable de gérer les \glspl{vlan}, c'est-à-dire
        manipuler l'extension Ethernet IEEE 802.1q correctement. Cet aspect
        permet de fournir l'isolation souhaitée entre les équipements des
        différents partenaires présents sur sites.
    \item Pour assurer la haute disponibilité (\gls{ha}) demandée, chaque site
        est équipé de trois liens d'accès Internet différents: un premier lien
        filaire \gls{fi} souvent une ADSL, un second \gls{bi} souvent une SDSL
        et un dernier lien cette fois-ci en espace libre par 4G.
    \item De même, le pare-feu de chaque site est en fait une paire du même
        modèle et reliés par une connexion \gls{ha} directe permettant la
        synchronisation automatique des configurations pour rendre la paire
        quasiment identique et la détection automatique de perte de l'autre.
    \item Le site de La Défense n'a pas de \glspl{vlan}, mais seulement une
        machine qui héberge deux machines virtuelles: une pour le \acrfull{fmg}
        et l'autre pour le \acrfull{faz}.
    \item Le \acrfull{soc} est relié par un tunnel au site de La Défense afin
        d'être en mesure de surveiller et contrôler tous les autres sites au
        travers des tunnels qui les relient à La Défense.
\end{itemize}

Le modèle de pare-feu retenu par Hynamics avec les \gls{presales} est le
Fortinet \acrlong{fgt} 40F. Il s'agit d'un des modèles faisant partie de la
gamme la moins puissante de Fortinet: les choses ont été faites de côté-là le
plus à la baisse possible car cela suffisait en nombre de ports physiques mais
aussi en termes de capacités de traitement puisqu'Hynamics n'avait pas formulé
de besoins de débit particulièrement élevés, la disponibilité importait plus.
Un aperçu du modèle est montré en Figure~\ref{fig:doc-hy/fgt-40f}.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/doc-hy/fgt-40f.png}
    \caption{Aperçu du modèle \acrlong{fgt} 40F}%
    \label{fig:doc-hy/fgt-40f}
\end{figure}

L'architecture physique des sites est présentée en
Figure~\ref{fig:doc-hy/site-phys-arch}. Les deux pares-feux de la paire sont
reliés à tous les routeurs des liens internet disponibles sur le site et au
commutateur central. Ils sont aussi reliés entre eux par un lien \gls{ha}.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/doc-hy/site-phys-arch.png}
    \caption{Architecture physique d'un site, ici Fontainebleau}%
    \label{fig:doc-hy/site-phys-arch}
\end{figure}

L'architecture logique des sites est présentée en
Figure~\ref{fig:doc-hy/site-logi-arch}. Elle montre comment sont organisés les
différents réseaux et \glspl{vlan} d'un site par rapport aux interfaces
physiques. Chaque partenaire possède son propre \gls{vlan} et son sous-réseau
comme domaine d'adressage pour mettre en place le partitionnement souhaité. Les
\glspl{vlan} sont placés sous l'inteface physique \texttt{lan1}.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/doc-hy/site-logi-arch.png}
    \caption{%
        Architecture logique d'un site, ici Auxerre avec ses différents réseaux%
    }%
    \label{fig:doc-hy/site-logi-arch}
\end{figure}

\subsection{Démarrage et premières opérations}%
\label{sub:mission::main::start}

Le projet commence pour le \gls{ocd-build}, tel qu'expliqué un peu plus tôt à la
Section~\ref{sec:mission::deroule-projet}, par une \acrfull{rli} relativement
courte lors de laquelle les membres internes sont introduits et présentés. Les
\gls{presales} nous transmettent aussi les informations importantes et le
contenu du projet jusqu'à ce jour. La présentation utilisée pour la \gls{rle} du
landemain est affinée en séance. Celle-ci, la \acrfull{rle}, est effectuée avec
des collaborateurs d'Hynamics présents pour faire les introductions de manière
similaire et clarifier l'état actuel du projet. Les ateliers techniques sont
planifiés pour les jours à venir.

Ces ateliers ont pour but global de concevoir l'architecture de plus en plus
précisément et directement avec le client. Une bonne partie des informations
spécifique au client, c'est-à-dire métier, est cependant obtenue plutôt par
écrit que par oral en réunion car plus efficace.  Cet aspect est abordé plus
amplement dans la Section~\ref{sub:mission::main::collec} suivante. Les ateliers
techniques ont aussi pour objectif d'expliquer certains des protocoles,
technologies, fonctionnalités ou même paradigmes spécifiques à la sécurité afin
que le client soit en mesure de prendre de bonnes décisions éclairées lorsque
nécessaire et de fournir des informations pertinentes lorsque demandées. En
effet, Hynamics est une entreprise petite et récemment fondée: il n'y a pas ou
pas encore de collaborateur ayant reçu de formation particulièrement poussée en
réseau ou en sécurité. Certaines des compétences nécessaires à la compréhension
de quelques aspects du projet n'étaient donc pas présente chez Hynamics, mais
cela n'était pas spécialement gênant, cela ajoutait simplement quelques petits
défis supplémentaires. D'autres aspects apparus en cours de projet n'ont
évidemment pas pu être expliqué dès le début, comme nous le verrons un peu plus
tard. Parmis ces choses à expliquer, deux étaient cruciales au projet: le
\gls{vpn-tls} et les \glspl{tun-ipsec}.

Le \gls{vpn-tls} est une forme de \gls{vpn} où un client rejoint virtuellement
un réseau privé en se connectant à un serveur distant visible publiquement et en
y faisant passer ses données au travers. \gls{tls} assure la confidentialité,
l'intégrité et une partie de l'authentification de la communication. Il s'agit
en général de celle du serveur grâce à un certificat. Celle du client est
spécifique à l'implémentation particulière: elle peut être réalisée grâce à une
paire nom d'utilisateur / mot de passe ou un certificat client suivi d'un
échange défi-réponse entre le serveur et le client. Une fois l'utilisateur
authentifié auprès du serveur, ce dernier lui affecte une adresse locale et
récupère une liste de routes auxquelles est inscrit le client et les lui fait
parvenir. Le client crée alors une interface de type tunnel sur son hôte avec
l'adresse reçue et applique aussi les routes reçues de sorte que tout processus
cherchant à réaliser une communication à destination du réseau privé distant
puisse bien la faire puisque le noyau du système gère ce routage. Par exemple,
si un client se connecte au serveur d'adresse publique \texttt{1.2.3.4} afin de
rejoindre le réseau \texttt{172.20.42.0/24}, le serveur lui affectera l'adresse
locale \texttt{172.20.42.252} imaginons. Une fois les informations détaillées
ci-dessus reçues par le client, il crée une interface tunnel d'adresse
\texttt{172.20.42.252/24} et une route où le réseau destination est
\texttt{172.20.42.0/24}, la passerelle \texttt{1.2.3.4} et l'interface émettrice
celle crée juste avant. Cette interface est sous écoute de l'implémentation du
client qui gère toutes les communications effectives avec le serveur. Ainsi
toutes les communications à destination de \texttt{172.20.42.0/24} se font bien
puisque le noyau les redirige vers le client, et le reste n'est pas perturbé
puisque la route ne redirige que ce qui est à destination du réseau en question.
Cette caractéristique de maintient de communications séparées est souvent nommée
en anglais <<\textit{split tunneling}>>.  Évidemment, il est tout à fait
possible de l'empêcher: il suffit de préciser côté serveur que la seule route à
envoyer est \texttt{0.0.0.0/0}, c'est-à-dire le réseau qui englobe toutes les
adresses IPv4 possibles. Ce mode de fonctionnement est souvent utilisé en
entreprise pour être en mesure d'observer tout le trafic de ses employés pour
filtrer le plus de contenu possible et ainsi obtenir une sécurité renforcée,
parfois au désagrément des utilisateurs. OpenVPN est un exemple d'implémentation
libre de ce type de \gls{vpn}. FortiClient est utilisé dans ce projet puisque
spécifique aux produits Fortinet.

Un \gls{tun-ipsec} ou plus précisément dans le cadre de ce rapport <<tunnel
IKE/ESP>>, c'est-à-dire le mode tunnel de la suite \gls{ipsec}, est une autre
forme de \gls{vpn} où deux routeurs établissent une connexion pour mettre en
relation virtuellement deux sous-réseaux privés par-dessus un réseau public. Le
protocole \gls{ike} est utilisé pour construire les clés et \gls{esp} pour
transporter les paquets de manière sécurisée. \gls{ike} est un protocole utilisé
par \gls{ipsec} pour mettre en place une \gls{sa} et qui utilise des certificats
ou clés pré-partagées pour construire un secret commun par Diffie-Hellmann et
ainsi en dériver des clés cryptographiques. Une \gls{sa} est l'établissement
d'attributs de sécurité partagés par deux entités de réseau pour permettre des
communications sécurisées, tels qu'un algorithme cryptographique et son mode de
fonctionnement ou une clé de chiffrement et d'autres paramètres dédiées aux
données à transmettre au travers de la connexion. Cette étape est souvent
appelée <<phase 1>>. \gls{esp} est un protocole de la suite \gls{ipsec} qui, en
mode tunnel, encapsule entièrement les paquets IP à transporter dans de nouveaux
paquets IP\@. Il permet de fournir authenticité en authentifiant la source,
intégrité grâce à des fonctions de hachage cryptographiques et confidentialité
grâce au chiffrement des paquets IP chargés.  Cette étape est souvent nommée
<<phase 2>>. C'est cette encapsulation qui permet de créer le réseau virtuel
sans affectation d'adresse locale ni de traduction d'adresse. En effet,
lorsqu'un hôte émet un message depuis le réseau privé de départ, il le fait avec
comme adresse source la sienne et la destination celle dans le réseau privé
d'arrivée. Il envoie ce paquet au routeur local puisqu'il l'a comme passerelle
configurée automatiquement ou bien manuellement au moins pour atteindre le
réseau de destination, si ce n'est pour tous les réseaux externes. Le routeur
réalise ensuite les opérations d'\gls{esp}: chiffre le paquet et le met comme
charge d'un nouveau paquet dont la source est l'adresse publique du routeur de
départ et la destination celle publique du routeur d'arrivée. Ce paquet est
transporté par le réseau partagé, par exemple l'Internet public, jusqu'au
routeur d'arrivée qui réalise les opérations inverses: déchiffre la charge et
l'émet sur le réseau privé local. Celui-ci transporte le paquet précédemment
encapsulé vers la destination qui est alors en mesure de répondre exactement de
la même manière, puisque la connexion et les configurations sont symétriques.

Un schéma résumant la différence entre \gls{vpn-tls} et \gls{tun-ipsec} d'un
point de vue réseau assez basique et haut niveau est disponible en
Figure~\ref{fig:misc/tls-vs-ipsec}.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/misc/tls-vs-ipsec.png}
    \caption{VPN TLS \textit{vs.} Tunnel IPsec --- fonctionnement typique}%
    \label{fig:misc/tls-vs-ipsec}
\end{figure}

Une fois les premières réunions passées et en parallèle des ateliers techniques,
les six pares-feux ont rapidement été commandés et livrés. Dès qu'ils ont été
réceptionnés, j'ai été chargé de tous les déballer, installer dans la salle de
tests des bureaux de Massy et configurer pour permettre un accès à distance pour
mon binôme de travail Silvain Bardy et moi-même. Il s'agissait ici simplement de
verser dans chaque machine la version du système d'exploitation choisie pour ce
projet et d'appliquer la même configuration partout, à quelques petites
exceptions près. De plus, j'ai dû exécuter un maximum de tests physiques que le
système d'exploitation rend disponible pour tenter de détecter automatiquement
si une pièce de matériel était défecteuse, en particulier le processeur, la
mémoire vive, le disque dur, la carte réseau, etc\ldots{} Cela permet de gérer
ce genre de cas le plus tôt possible et directement au sein d'\gls{ocd}. Pour
chaque équipement, une petite <<Fiche de Contrôle Qualité>> devait donc être
remplie afin d'acter que les tests s'étaient bien déroulés à ce moment-là.

\subsection{Collecte des informations et déploiement sur sites}%
\label{sub:mission::main::collec}

À partir de ce moment-là, les collaborateurs d'Hynamics devaient revenir vers
nous dès qu'ils auraient rempli d'une manière la plus exhaustive et correcte
possible un <<fichier de collecte>>. Celui-ci résume en un endroit l'ensemble
des informations que le \gls{ocd-build} ne peut pas déduire de ce qui a été
discuté en réunions et de l'architecture haut niveau précédemment conçue,
c'est-à-dire les informations métier. Cela comprend la liste des \glspl{vlan}
par site, les adresses des sous-réseaux du site et celle du pare-feu dedans, les
routes particulières, les paramètres \gls{vpn-tls}, les différents
\glspl{tun-ipsec} et surtout les règles de filtrage. Avec cette fiche bien
remplie, la rédaction d'un \gls{dsd} et l'implémentation qui s'ensuit seraient
grandement facilitées et en particulier ici, elle deviendraient presque
immédiates au vu de la taille du projet relativement petite.

Cependant, cette fiche ne s'est pour ainsi dire jamais vraiment remplie
complètement. En effet, il y a d'abord eu des difficultés liées simplement au
manque de compétences techniques chez les collaborateurs d'Hynamics qui créait
une difficulté au remplissage des informations demandées et un peu de confusion
à certains moments. Cela n'était pas du tout surprenant pour autant puisqu'ils
avaient bien fait appel à \gls{ocd} pour ça. Nous avons donc simplement dû gérer
cet aspect-là avec eux. Par contre, ce qui a vraiment ralenti le projet de
côté-là a surtout été les partenaires d'Hynamics qui ont mis un temps
considérable à fournir les informations nécessaires, en particulier un. Cela a
demandé de décaler dans le temps plusieurs étapes du projet à de multiples
reprises afin de pouvoir les faire correctement, mais aussi de revenir maintes
fois sur des documents et configurations qui auraient normalement dû êtres
terminés et confirmés assez tôt dans le projet. C'est pour cette raison que je
pense que le mode de travail en cascade n'était pas très adapté à ce projet:
accepter quelques cycles parmi un V aurait été assez efficace à mon avis au lieu
de décaler les choses pour toujours essayer de les faire dans l'ordre prévu
alors qu'on ne le fait en réalité déjà plus. Il y a donc eu de nombreux
va-et-vient tout au long du projet pour échanger avec le client à propos de
diverses nouvelles informations ou mises-à-jour.

C'est aussi à partir de ce moment-là que j'ai été chargé de réaliser en majeure
partie la rédaction du \acrfull{dsd}, avec l'aide et validation régulières de
mon binôme bien entendu. Le \gls{dsd} reprend notamment les informations du
fichier de collecte que nous avions reçues et qui étaient utilisables, mais
aussi certaines ajoutées comme les architectures physiques et logiques, le
détail du raccordement physique interface par interface, les routes, le
\gls{vpn-tls}, les \glspl{tun-ipsec}, la \acrfull{ha}, l'administration et la
supervision par le \gls{soc} du \gls{ocd-run}. Comme expliqué ci-dessus, le
manque d'informations arrivées à temps nous a fait rédiger une première version
assez incomplète et par la suite plusieurs itérations pour finalement assez peu
de valeur ajoutée puisque la configuration évoluait en général avant le
\gls{dsd}, ce qui lui faisait alors perdre une bonne partie de son intérêt de
spécification au préalable. C'est allé jusqu'à continuer ça même après mon
départ suite à la fin de ma période de stage.

En parallèle, les pares-feux sont paramétrés pour simuler l'environnement de
production tout en restant dans la zone de test: nous faisions avancer la
pré-production. Cela nous a permis de mettre en place et vérifier la \gls{ha}
entre chaque paire de machines ainsi que le bon fonctionnement du \gls{vpn-tls},
au moins pour être en mesure de modifier à distance les paramètres des
pares-feux. La première configuration est ainsi assez basique, juste de quoi
permettre l'accès à distance, donc quelques utilisateurs et règles associées. Le
reste ne pourra venir qu'après puisque les informations manquaient à ce
moment-là. Les interfaces physiques et sous-interfaces \gls{vlan} sont
configurées pour que leurs adresses correspondent bien à ce qui allait être
utilisé juste après l'installation sur site et c'est qui a été testé. La période
de \gls{staging} s'est terminée assez rapidement puisque les choses étaient
prévues pour bien avancer peu de temps après et que peu de changements devaient
être faits, quelques jours seulement ont suffit. Après cela, j'ai dû réaliser
les opérations inverses par rapport à la précédente
Section~\ref{sub:mission::main::start}, c'est-à-dire éteindre tous les six
pares-feux, les retirer de la salle test, les remballer et les confier pour les
faire livrer au client qui s'occupera de les répartir entre les sites.
L'installation sur site se fait ensuite quelques jours plus tard, mon binôme
s'est occupé de La Défense, moi de Fontainebleau et Hynamics d'Auxerre
puisqu'ils se sentaient confiants après nous avoir observés les deux fois
précédentes et que le site est un peu plus loin de Paris que les deux autres.
Les déploiement sur site se sont tous bien déroulés et ont ainsi permis l'accès
à distance pour les configurer dès leur installation.

\subsection{Implémentation de la configuration}%
\label{sub:mission::main::implem}

À partir du moment où les différentes machines dont nous avions la
responsabilité directe pour la durée du projet avaient été installées, nous
avons donc procédé à l'évolution du \gls{dsd} et de la configuration autant que
nous le pouvions avec les informations qui nous arrivaient petit à petit, tel
que mentionné précédemment. Je vais donc reprendre ici certaines des opérations
que j'ai menées et configurations que j'ai mises en place, elle ne seront
simplement pas nécessairement montrées dans l'ordre chronologique dans lequel
elles ont effectivement été appliquées.

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.5\linewidth]{img/fgt-auxr/interfaces.png}
    \caption{Interfaces du pare-feu d'Auxerre}%
    \label{fig:fgt-auxr/interfaces}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/fgt-auxr/routes.png}
    \caption{Routes statiques du site d'Auxerre}%
    \label{fig:fgt-auxr/routes}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.6\linewidth]{img/fgt-auxr/ipsec-phase1.png}
    \caption{Extrait d'une phase 1 de FillinDrive sur le site d'Auxerre}%
    \label{fig:fgt-auxr/ipsec-phase1}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.5\linewidth]{img/fgt-auxr/ipsec-phase2.png}
    \caption{Extrait de phases 2 de FillinDrive sur le site d'Auxerre}%
    \label{fig:fgt-auxr/ipsec-phase2}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.6\linewidth]{img/fgt-auxr/bgp-neighbors.png}
    \caption{Extrait de la configuration \gls{bgp} du site d'Auxerre}%
    \label{fig:fgt-auxr/bgp-neighbors}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.4\linewidth]{img/fgt-auxr/bgp-nets.png}
    \caption{Réseaux distribués par \gls{bgp} sur le site d'Auxerre}%
    \label{fig:fgt-auxr/bgp-nets}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.6\linewidth]{img/fgt-auxr/acl.png}
    \caption{Filtres d'adresses pour le \gls{bgp} de FillinDrive sur Auxerre}%
    \label{fig:fgt-auxr/acl}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.7\linewidth]{img/fgt-auxr/route-maps.png}
    \caption{Associations de routes \gls{bgp} de FillinDrive sur Auxerre}%
    \label{fig:fgt-auxr/route-maps}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/addresses.png}
    \caption{Adresses configurées centralement sur le \acrlong{fmg}}%
    \label{fig:fmg/addresses}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/services.png}
    \caption{Services configurés centralement sur le \acrlong{fmg}}%
    \label{fig:fmg/services}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/interfaces.png}
    \caption{Interfaces normalisées sur le \acrlong{fmg}}%
    \label{fig:fmg/interfaces}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/policy-packages.png}
    \caption{\Glspl{pp} du \acrlong{fmg}}%
    \label{fig:fmg/policy-packages}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.8\linewidth]{img/fmg/ssl-mappings.png}
    \caption{%
        Associations des portails aux groupes d'utilisateurs pour le
        \gls{vpn-tls} sous \acrlong{fmg}%
    }%
    \label{fig:fmg/ssl-mappings}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/ssl-portal.png}
    \caption{Portails \gls{vpn-tls} sous \acrlong{fmg}}%
    \label{fig:fmg/ssl-portal}
\end{figure}

\FloatBarrier{}
\subsection{Mise en place des tests et migration}%
\label{sub:mission::main::tests}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.4\linewidth]{img/sw-auxr/vlans.png}
    \caption{Configuration des \glspl{vlan} du commutateur central d'Auxerre}%
    \label{fig:sw-auxr/vlans}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.7\linewidth]{img/sw-auxr/fw-ifs.png}
    \caption{%
        Configuration des interfaces du commutateur central connectées au
        pare-feu d'Auxerre%
    }%
    \label{fig:sw-auxr/fw-ifs}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = 0.5\linewidth]{img/sw-auxr/esxi-ifs.png}
    \caption{%
        Configuration des interfaces du commutateur central servant au serveur
        ESXi (hyperviseur) d'Auxerre%
    }%
    \label{fig:sw-auxr/esxi-ifs}
\end{figure}

\FloatBarrier{}
\subsection{Transferts de connaissances}%
\label{sub:mission::main::trans}


\section{Relations humaines et management}%
\label{sec:mission::rhm}


\chapter{Responsabilité sociétale des entreprises}%
\label{cha:rse}

\section{Economie}%
\label{sec:rse::eco}

\section{Social}%
\label{sec:rse::social}

\section{Environnement}%
\label{sec:rse::env}

\section{Gouvernance}%
\label{sec:rse::gouv}

\section{Santé et Sécurité au Travail}%
\label{sec:rse::sst}


\chapter{Bilan}%
\label{cha:bilan}

\section{Retour d'expérience}%
\label{sec:bilan::ret-exp}


\chapter{Conclusion}%
\label{cha:conclu}

\section{Perspectives}%
\label{sec:conclu::persp}


\chapter{Annexes}%
\label{cha:annexes}

\section{\acrlong{fgt}}%
\label{sec:annexes::fgt}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fgt-auxr/dashboard.png}
    \caption{Tableau de bord de l'interface Web d'un \acrlong{fgt}}%
    \label{fig:fgt-auxr/dashboard.png}
\end{figure}

\section{\acrlong{fmg}}%
\label{sec:annexes::fmg}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/device-manager.png}
    \caption{Vue du gestionnaire des appareils configurés par un \acrlong{fmg}}%
    \label{fig:fmg/device-manager.png}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/user-groups.png}
    \caption{Vue des groupes d'utilisateurs sous \acrlong{fmg}}%
    \label{fig:fmg/user-groups}
\end{figure}

\begin{figure}[h!]
    \centering
    \includegraphics[width = \linewidth]{img/fmg/vips.png}
    \caption{Liste des VIPs configurées par et pour le \gls{ocd-run}}%
    \label{fig:fmg/vips.png}
\end{figure}

Comme le montre la Figure~\ref{fig:fmg/vips.png}, des VIPs ont été configurées
sur les pares-feux. Une \textit{Virtual IP address} ou <<adresse IP virtuelle>>
est une fonctionnalité proposées par de nombreux équipements réseau et qui
permet de faire écouter le système d'exploitation sur une certaine interface
mais avec une adresse potentiellement autre que celle de l'interface. Une
configuration possible est de rediriger tout paquet y arrivant avec l'adresse
VIP configurée comme adresse destination vers une autre adresse dans le réseau.
Il est aussi possible de faire ceci en fonction du contenu, ce qui peut être
utilisé pour mettre en place des formes de passerelles de redirection. La
première option a été choisie par le \gls{ocd-run} car les adresses des
interfaces \gls{vlan} dans les sous-réseaux dédiés au client, à l'administration
et à la supervision rentraient en conflit avec le plan d'adressage interne au
\gls{soc} et à \gls{ocd}. Ces VIPs leur ont donc permis de joindre les machines
en question mais comme si elles étaient directement dans les sous-réseaux qu'ils
avaient choisis au lieu de celui effectivement utilisé.

\section{Résumé des finances}%
\label{sec:annexes::finances-ocd}

\begin{longtable}{|l|r|r|r|r|}
    \hline
    \textbf{Performance} & \textbf{2020} & \textbf{2019} & \textbf{2018} &
    \textbf{2017} \\ \hline
        Chiffre d'affaires (\texteuro) & 301M & 274M & 219M & 191M \\ \hline
        Marge brute (\texteuro) & 204M & 179M & 153M & 126M \\ \hline
        EBITDA --- EBE (\texteuro) & 12,5M & 13,3M & 8,97M & 5,94M \\ \hline
        Résultat d'exploitation (\texteuro)
            & 3,63M & 4,8M & 1,43M & 1,2M \\ \hline
        Résultat net (\texteuro) & 1,83M & 2,13M & 883K & 1,39M \\ \hline
    \textbf{Croissance} & \textbf{2020} & \textbf{2019} & \textbf{2018} &
    \textbf{2017} \\ \hline
        Taux de croissance du CA (\%) & 9,8 & 25,1 & 14,8 & 35,6 \\ \hline
        Taux de marge brute (\%) & 67,7 & 65,2 & 69,7 & 65,8 \\ \hline
        Taux de marge d'EBITDA (\%) & 4,2 & 4,8 & 4,1 & 3,1 \\ \hline
        Taux de marge opérationnelle (\%) & 1,2 & 1,8 & 0,7 & 0,6 \\ \hline
    \textbf{Gestion BFR} & \textbf{2020} & \textbf{2019} & \textbf{2018} &
    \textbf{2017} \\ \hline
        BFR (\texteuro) & 38,4M & 40,8M & 2,07M & 7,33M \\ \hline
        BFR exploitation (\texteuro) & 55,8M & 69,9M & 55,6M & 58,2M \\ \hline
        BFR hors exploitation (\texteuro) & -17,4M
            & -29,1M & -53,5M & -50,9M \\ \hline
        BFR (j de CA) & 46,6 & 54,3 & 3,4 & 14 \\ \hline
        BFR exploitation (j de CA) & 67,7 & 93,1 & 92,6 & 111 \\ \hline
        BFR hors exploitation (j de CA) & -21,1 & -38,8 & -89,2 & -97,4 \\ \hline
        Délai de paiement clients (j) & 168 & 194 & 176 & 199 \\ \hline
        Délai de paiement fournisseurs (j) & 173 & 175 & 140 & 142 \\ \hline
        Ratio des stocks / CA (j) & 12,9 & 16,7 & 10,9 & 7,7 \\ \hline
    \textbf{Autonomie financière} & \textbf{2020} & \textbf{2019} &
    \textbf{2018} & \textbf{2017} \\ \hline
        Capacité d'autofinancement (\texteuro)
            & 10,8M & 10,6M & 8,27M & 5,28M \\ \hline
        Capacité d'autofinancement / CA (\%) & 3,6 & 3,9 & 3,8 & 2,8 \\ \hline
        Fonds de roulement net global (\texteuro)
            & 41,2M & 43M & 6,02M & 10,9M \\ \hline
        Couverture du BFR & 1,1 & 1,1 & 2,9 & 1,5 \\ \hline
        Trésorerie (\texteuro) & 2,96M & 2,31M & 3,98M & 3,48M \\ \hline
        Dettes financières (\texteuro) & 40M & 50,8M & 16M & 21M \\ \hline
        Capacité de remboursement & 3,4 & 4,6 & 1,5 & 3,3 \\ \hline
        Ratio d'endettement (Gearing) & 0,5 & 0,7 & 0,2 & 0,3 \\ \hline
        Autonomie financière (\%) & 22,9 & 22,8 & 29,5 & 30,2 \\ \hline
        Taux de levier (DFN/EBITDA) & 3 & 3,7 & 1,3 & 3 \\ \hline
    \textbf{Solvabilité} & \textbf{2020} & \textbf{2019} & \textbf{2018} &
    \textbf{2017} \\ \hline
        Etat des dettes à 1 an au plus (\texteuro)
            & 199M & 182M & 142M & 131K \\ \hline
        Liquidité générale & 1,2 & 1,2 & 1 & 1,04K \\ \hline
        Couverture des dettes & 2,3 & 1,9 & 7,1 & 4,6 \\ \hline
    \textbf{Rentabilité} & \textbf{2020} & \textbf{2019} & \textbf{2018} &
    \textbf{2017} \\ \hline
        Marge nette (\%) & 0,6 & 0,8 & 0,4 & 0,7 \\ \hline
        Rentabilité sur fonds propres (\%) & 2,6 & 3,2 & 1,3 & 2,1 \\ \hline
        Rentabilité économique (\%) & 0,6 & 0,7 & 0,4 & 0,6 \\ \hline
        Valeur ajoutée (\texteuro) & 103M & 94,2M & 77M & 62,6M \\ \hline
        Valeur ajoutée / CA (\%) & 34,1 & 34,4 & 35,1 & 32,8 \\ \hline
    \textbf{Structure d'activité} & \textbf{2020} & \textbf{2019} &
    \textbf{2018} & \textbf{2017} \\ \hline
        Salaires et charges sociales (\texteuro)
            & 89,2M & 78,9M & 66,6M & 55,3M \\ \hline
        Salaires / CA (\%) & 29,6 & 28,8 & 30,4 & 29 \\ \hline
        Impôts et taxes (\texteuro) & 4,11M & 4,09M & 3,27M & 2,66M \\ \hline
    \caption{Résultats financiers~\cite{finances-ocd}}%
    \label{tab:annexes::finances-ocd::tab}
\end{longtable}


\printbibliography[title = Références]

\listoffigures

\glsaddall{}
\printglossary[type = main]
\printglossary[type = \acronymtype, title = Acronymes]



\end{document}
